float K[4][12] = {{-7.72638786434289,-3.79986304350233,-30.4778332422784,-14.0406137267744,114.358226924435,59.4038073797469,-0.840248289296369,-20.8733385451354,14.8598929789533,-34.7274642113803,4.66850999979966,0.0625099999542301},
{-48.7081151967386,-15.7808480451528,-40.5352344904278,-7.63779797395739,-120.773267836874,-65.9240535162823,-109.156529532724,-164.077098090239,-147.017199996697,-207.502355681035,4.66850999988778,0.0625099999762389},
{2.12353160117841,-3.09352102639369,113.322371847828,17.8710313191528,114.875274292812,59.5324411506831,102.616054672205,68.3101526087798,360.357565875910,536.112880043485,4.66850999984071,0.0625099999629025},
{41.4010114722254,9.76427211658180,-55.2192641144560,-9.10257961827559,-120.777993380417,-65.9221550141586,-5.52923682049534,103.730324085139,-241.110218872590,-306.793020155149,4.66851000047189,0.0625100001066373}
};
/*
float K[4][12] = {{ -7.73, -3.80, -30.480, -14.040, 114.36, 59.4, -0.840, -20.870, 14.860, -34.730, 4.67, 0.06},
  { -48.710, -15.780, -40.540, -7.64, -120.77, -65.920, -109.16, -164.08, -147.02, -207.50, 4.67, 0.06},
  {2.12, -3.09, 113.32, 17.870, 114.88, 59.530, 102.62, 68.310, 360.36, 536.11, 4.67, 0.06},
  {41.4, 9.76, -55.220, -9.10, -120.78, -65.920, -5.53, 103.73, -241.11, -306.79, 4.67, 0.06}
};*/
float x[12] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
float res1 = 0;
float res2 = 0;
float res3 = 0;
float res4 = 0;

void setup()
{
  Serial.begin(2000000);
  pinMode(13, OUTPUT);
  digitalWrite(13, HIGH);
}
int a = 0;
int check = 0;
int check1 = 0;
char y[100];
int j = 0;
char temp[100];
void loop()
{
  if (Serial.available())
  {
    char z;
    z = Serial.read();
    if (z == 0)
    {}
    else if (z == 'b')
    {
      check1 = 1;
    }
    else if (check1 == 1)
    {
      if (a == 11)
      {
        check = 1;
      }
      else if (z == 'a')
      {
        temp[j++] = '\0';
        x[a] = atof(temp);
        operat();
        a++;
        j = 0;
      }
      else
      {
        temp[j++] = z;
      }
    }
  }
  if (check == 1)
  {
    sendata();
  }
}

void operat()
{
  res1 = x[a] * K[0][a] + res1;
  res2 = x[a] * K[1][a] + res2;
  res3 = x[a] * K[2][a] + res3;
  res4 = x[a] * K[3][a] + res4;
}
void sendata()
{
  for (int i = 0; i < 12; i++)
    x[i] = 0;
    String data ="b" + String(res1,10) + "a" + String(res2,10) + "a" + String(res3,10) + "a" + String(res4,10) + "a";

  Serial.print(data);
  res1 = 0;
  res2 = 0;
  res3 = 0;
  res4 = 0;
  a = 0;
  check = 0;
  check1 = 0;
  j = 0;
}
